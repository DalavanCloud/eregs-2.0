<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <title>RegML - eRegs 2.0</title>
  

  <link rel="shortcut icon" href="../img/favicon.ico">

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "RegML";
    var mkdocs_page_input_path = "regml.md";
    var mkdocs_page_url = "/regml/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 

  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> eRegs 2.0</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="..">Installation and Data Loading</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 current">
        <a class="current" href="./">RegML</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#logic-motivation-and-use">Logic, motivation, and use</a></li>
                
                    <li><a class="toctree-l4" href="#regulations-parser">regulations-parser</a></li>
                
                    <li><a class="toctree-l4" href="#the-logic-of-regml">The logic of RegML</a></li>
                
                    <li><a class="toctree-l4" href="#powering-eregs-20">Powering eRegs 2.0</a></li>
                
            
            </ul>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../api/">API</a>
        
    </li>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">eRegs 2.0</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
    
    <li>RegML</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="logic-motivation-and-use">Logic, motivation, and use</h1>
<p>This part of the documentation explains the motivation for switching to an XML format and the way in which this change simplifies the process of adding content into eRegs.</p>
<h2 id="regulations-parser">regulations-parser</h2>
<p>The process of creating the content that powers eRegs begins with a Python program called <a href="https://github.com/cfpb/regulations-parser">regulations-parser</a>. The parser takes as its input the raw XML from the Federal Register. In the past, the parser would generate the JSON layers described in the <a href="../api/">API</a> section, and they would be stored in the database as indicated on the diagram. Now, the parser generates a set of XML files; the first of these files represents the document that originates the regulation (e.g. <code>2011-31712.xml</code> for the original document of Regulation C), and the subsequent XML documents represent notices that modify the <em>previous</em> version of the regulation. Thus, if <code>2011-31712</code> is the original version, and <code>2012-31311</code> is the notice representing the chronologically next modification, then "applying" the <em>notice</em> <code>2011-31311</code> to the <em>regulation</em> <code>2011-31712</code> generates the <em>new reguation</em> <code>2011-31311</code>. The <em>next</em> notice will then modify the regulation <code>2011-31311</code>, and so on.</p>
<p>The benefit of this structure is that fixes that are made upstream propagate downstread. In the old pipeline, modifying the individual JSON files was too complicated, so any changes had to be made to the source Federal Register XML and the entire parser needed to be run again. This made the process of compiling regulations hopelessly opaque and slow, especially for larger regulations like Z. With the introduction of RegML, initial mistakes in compilation can be fixed in the root version, and then incremental fixes can be made in the notices, which are typically much smaller than a fully compiled regulation. Once you have fixed version <em>N</em> and notice <em>N+1</em>, version <em>N+1</em> which is obtained by applying notice <em>N+1</em> to version <em>N</em>, will maintain those fixes. This makes it possible to incrementally fix mistakes in regulation compilation.</p>
<p>Additionally, fixing an XML file that can be validated with a schema is much easier than fixing the typically malformed, non-semantic XML that the Federal Register provides. RegML was designed with the goal of capturing the entire semantics of a regulation, whereas the Federal Register XML is designed to be compiled to a printable PDF. In particular, RegML is designed to have a 1-1 correspondence between XML node and Django database model, as well as with the goal of separating visual representation from semantic markup. Thus, fixing errors in a RegML file requires substantially less time and effort.</p>
<h2 id="the-logic-of-regml">The logic of RegML</h2>
<p>RegML is designed to capture regulation semantics, separate model structure from presentation, and maintain an isomorphism between XML node and database row. You can find <a href="https://github.com/cfpb/regulations-schema">the schema for RegML</a> on Github. The schema is amply documented and should be mostly self-explanatory; it captures both the structure of a regulatory document in the form of a hierarchy of nodes, and the semantics of the text that indicate linkages between different parts of the regulation, such as definitions and references.</p>
<h2 id="powering-eregs-20">Powering eRegs 2.0</h2>
<p>As documented in the <a href="../api/">API</a> section and the <a href="..">introduction</a>, the new eRegs backend replaces the Byzantine collection of JSON layers with a storage logic based on nested sets. Now, instead of breaking the RegML file into layers and then reassembling them on the site backend, the entire RegML tree can just be imported directly into the database. This eliminates the necessity of uploading large files (an update to Regulation Z can be as much as ~10Gb), and makes it much easier to store the canonical representation of a regulation in a repository. This also aids automation, as it is possible to automatically pull down an updated production branch of a repository and insert it into the database without the need of passing through multiple pipeline stages.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../api/" class="btn btn-neutral float-right" title="API">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href=".." class="btn btn-neutral" title="Installation and Data Loading"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href=".." style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../api/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
